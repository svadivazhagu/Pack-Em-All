$(document).ready(function(){console.log("Page Loaded!");randomSearch()});function upload(){var data=getUploadQuery();if(data==null){var errormsg=document.getElementById("errormsg");errormsg.classList.remove("hidden")}else{var xml=new XMLHttpRequest();xml.open("POST","/upload");xml.onreadystatechange=handle_res_post;xml.send(JSON.stringify(data))}}function update(){var data=getUploadQuery();if(data==null){var errormsg=document.getElementById("errormsg");errormsg.classList.remove("hidden")}else{var xml=new XMLHttpRequest();xml.open("POST","/update");xml.onreadystatechange=handle_res_post;xml.send(JSON.stringify(data))}}function handle_res_post(){switch(this.readyState){case 1:console.log("Opened Query MSG");break;case 2:console.log("Reading Query HEADER");break;case 3:console.log("Loading Query Data");break;case 4:if(this.status==200){var myArr=JSON.parse(this.responseText);console.log(this.responseText);if(myArr.responselen!=null){console.log("That item was in the array already");$('#updatemodal').modal('toggle')}else{var table=document.getElementById("tablebody");table.removeChild(table.children[0]);document.getElementById(myArr.link).remove();var row=document.createElement("tr");row.id=myArr.link;row.innerHTML=('<td>'+myArr.teamname+'</td><td>'+myArr.author+'</td><td>'+myArr.format+'</td><td>'+myArr.gen+'</td><td><a href="'+myArr.link+'"target="_blank">'+myArr.link+'</a></td><td id="del" onclick="deleteitem(\''+myArr.link+'\')" class="delete"><i class="fa fa-trash-o"></i></td>');table.appendChild(row)}}else if(this.status==404){console.log("Error 404")}else{console.log('Error 503')}break;default:console.log("Something Went wrong...");break}}function getUploadQuery(){var input_data=document.getElementById("input_pokepaste");var url=urlCheck(input_data.value);var input_name=document.getElementById("input_teamname");var input_author=document.getElementById("input_author");var input_format=document.getElementById("input_format");var input_gen=document.getElementById("input_gen");if(input_data.value==''||url==1||input_name.value==''||input_author.value==''){console.log("YOU DONE MESSED UP");return null}var data={'teamname':input_name.value,'author':input_author.value,'format':input_format.value,'gen':input_gen.value,'link':input_data.value};return data}function urlCheck(url){var source=url.toString().substring(0,20);if(source==="https://pokepast.es/"){console.log("Good LINK");console.log(source);return 0}else{console.log("BAD LINK");console.log(source);return 1}}function search(){var data=getSearchQuery();var xml=new XMLHttpRequest();xml.onreadystatechange=handle_res_get;xml.open("POST","/search");xml.send(JSON.stringify(data))}function getSearchQuery(){var search_name=document.getElementById("search_teamname");var search_author=document.getElementById("search_author");var search_format=document.getElementById("search_format");var search_gen=document.getElementById("search_gen");var line={'teamname':search_name.value,'author':search_author.value,'format':search_format.value,'gen':search_gen.value};return line}function handle_res_get(){switch(this.readyState){case 1:console.log("Opened Query MSG");break;case 2:console.log("Reading Query HEADER");break;case 3:console.log("Loading Query Data");break;case 4:if(this.status==200){var myArr=JSON.parse(this.responseText);console.log(myArr.result.length);var parent=document.getElementById("tablebody");parent.innerHTML='';if(myArr.result.length=='0'){var row=document.createElement("tr");row.innerHTML=('<td colspan="6">No Teams Available, Sorry...</td>');parent.appendChild(row)}else{var results=myArr.result;for(var i=0;i<myArr.result.length;i+=1){var row=document.createElement("tr");row.id=results[i].link;row.innerHTML=('<td>'+results[i].teamname+'</td><td>'+results[i].author+'</td><td>'+results[i].format+'</td><td>'+results[i].gen+'</td><td><a href="'+results[i].link+'"target="_blank">'+results[i].link+'</a></td><td id="del" onclick="deleteitem(\''+results[i].link+'\')" class="delete"><i class="fa fa-trash-o"></i></td>');parent.appendChild(row)}}}else if(this.status==404){console.log("Error 404")}else{console.log('Error 503')}break;default:console.log("Something Went wrong...");break}}function deleteitem(id){console.log(id);$('#deletemodal').modal('toggle');var modalbod=document.getElementById("deletemodalbody");modalbod.innerHTML=(''+id);var row=document.getElementById(id);console.log(id);}function deleteitemconfirm(){var modalbod=document.getElementById("deletemodalbody");var id=modalbod.innerHTML;var row=document.getElementById(id);console.log(id);var data=getdelrow(row);row.parentElement.removeChild(row);var xml=new XMLHttpRequest();xml.open("POST","/delete");xml.send(JSON.stringify(data))}function getdelrow(row){var children=row.childNodes;var name=children[0].innerHTML;var auth=children[1].innerHTML;var format=children[2].innerHTML;var gen=children[3].innerHTML;var link=row.id;var data={'teamname':name,'author':auth,'format':format,'gen':gen,'link':link};console.log(data);return data}function randomSearch(){console.log("Random Search...");var data={};var xml=new XMLHttpRequest();xml.open("POST","/random");xml.onreadystatechange=handle_res_get;xml.send(JSON.stringify(data))}
